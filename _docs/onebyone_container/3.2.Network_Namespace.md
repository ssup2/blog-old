---
title: 3.2. Network Namespace
category: 하나씩 익히는 Container
date: 2020-05-03T12:00:00Z
lastmod: 2020-05-03T12:00:00Z
comment: true
adsense: true
---

{% highlight console %}
(host) docker run --rm -it --privileged --name netshoot_a nicolaka/netshoot bash

(netshoot a)# ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
25: eth0@if26: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default
    link/ether 02:42:ac:11:00:03 brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet 172.17.0.3/16 brd 172.17.255.255 scope global eth0
       valid_lft forever preferred_lft forever

(netshoot a)# route add -host 8.8.8.8 dev eth0
(netshoot a)# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         172.17.0.1      0.0.0.0         UG    0      0        0 eth0
8.8.8.8         0.0.0.0         255.255.255.255 UH    0      0        0 eth0
172.17.0.0      0.0.0.0         255.255.0.0     U     0      0        0 eth0
{% endhighlight %}
<figure>
<figcaption class="caption">[Shell 1] Netshoot A Container Network</figcaption>
</figure>

{% highlight console %}
(host) docker run --rm -it --privileged --name netshoot_b nicolaka/netshoot bash

(netshoot b)# ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
29: eth0@if30: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default
    link/ether 02:42:ac:11:00:04 brd ff:ff:ff:ff:ff:ff link-netnsid 0
    inet 172.17.0.4/16 brd 172.17.255.255 scope global eth0
       valid_lft forever preferred_lft forever

(netshoot b)# route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         172.17.0.1      0.0.0.0         UG    0      0        0 eth0
172.17.0.0      0.0.0.0         255.255.0.0     U     0      0        0 eth0
{% endhighlight %}
<figure>
<figcaption class="caption">[Shell 2] Netshoot B Container Network</figcaption>
</figure>

[Shell 1]과 [Shell 2]는 각 Netshoot Container 내부에서 Network Interface 조회 및 Routing Table 조작 및 조회를 하는 과정을 나타내고 있다. Netshoot은 대부분의 Network Tool이 포함된 Container Image이다. Netshoot A Container와 Netshoot B Container가 다른 IP를 갖고 있는것을 확인할 수 있다. 또한 Netshoot A Container에서 IP "8.8.8.8" 관련 Routing Rule을 추가하였지만 Netshoot B Container에서는 관련 Routing Rule을 확인할 수 없는것을 알수 있다. 이러한 현상을 이해하기 위해서는 Network Namespace를 이해하고 있어야 한다.

![[그림 1] Network Namespace]({{site.baseurl}}/images/onebyone_container/Network_Namespace/Network_Namespace.PNG){: width="700px"}


---
title: Golang Keycloak SAML 이용
category: Programming
date: 2022-02-20T00:00:00Z
lastmod: 2022-02-20T00:00:00Z
comment: true
adsense: true
---

Golang을 활용하여 Keycloak의 SAML을 이용하고 분석한다.

### 1. 인증서 생성

SAML의 Service Provider는 인증서가 필요하다. 다음의 명령어로 인증서를 생성한다.

~~~console
# openssl req -x509 -newkey rsa:2048 -keyout myservice.key -out myservice.cert -days 365 -nodes -subj "/CN=myservice.example.com"
~~~

### 2. Service Provider Code

{% highlight golang linenos %}
// https://github.com/ssup2/golang-Google-SAML/blob/master/main.go
// Print SAML request
func samlRequestPrinter(next http.Handler) http.Handler {
	return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		fmt.Printf("%+v\n", r)
		next.ServeHTTP(w, r)
	})
}

// Echo session info
func echoSession(w http.ResponseWriter, r *http.Request) {
	fmt.Fprintf(w, "%v\n", samlsp.SessionFromContext(r.Context()))
}

func main() {
	// Load certificate keypair
	keyPair, err := tls.LoadX509KeyPair("myservice.cert", "myservice.key")
	if err != nil {
		panic(err)
	}
	keyPair.Leaf, err = x509.ParseCertificate(keyPair.Certificate[0])
	if err != nil {
		panic(err)
	}

	// Get identity provider info from identity provider meta URL
	idpMetadataURL, err := url.Parse("http://localhost:8080/realms/ssup2/protocol/saml/descriptor")
	if err != nil {
		panic(err)
	}
	idpMetadata, err := samlsp.FetchMetadata(context.Background(), http.DefaultClient,
		*idpMetadataURL)
	if err != nil {
		panic(err)
	}

	// Get SAML service provider middleware
	rootURL, err := url.Parse("http://localhost:8000")
	if err != nil {
		panic(err)
	}
	samlSP, _ := samlsp.New(samlsp.Options{
		URL:         *rootURL,
		Key:         keyPair.PrivateKey.(*rsa.PrivateKey),
		Certificate: keyPair.Leaf,
		IDPMetadata: idpMetadata,
	})

	// Set SAML's metadata and ACS (Assertion Consumer Service) endpoint with SAML request printer
	http.Handle("/saml/", samlRequestPrinter(samlSP))

	// Set session handler to print session info
	app := http.HandlerFunc(echoSession)
	http.Handle("/session", samlSP.RequireAccount(app))

	// Serve HTTP
	http.ListenAndServe(":8000", nil)
}
{% endhighlight %}
<figure>
<figcaption class="caption">[Code 1] Golang SAML Service Provider Example</figcaption>
</figure>

[Code 1]은 SAML Identity Provider를 통해서 User를 인증하고, 인증 과정을 통해서 얻은 SAML Session 정보를 출력하는 SAML Service Provider App이다. 동작 과정은 다음과 같다.

* User가 Service Provider의 "/session" Path에 접속하면 Service Provider는 RequireAccount() Middleware 함수를 통해서 SAML Request를 Identity Provider에게 보내어 User가 인증을 할 수 있도록 Redirect한다. SAML Request에는 인증후 User가 요청한 URL 정보도 포함되어 있다. 
* Identity Provider를 통해서 인증이 완료되면 Identity Provider는 이전에 등록된 Service Provider의 ACS Endpoint인 "/saml/acs"로 User를 다시 Redirect하고, 인증 정보인 SAML Response도 ACS Endpoint에 같이 전송한다. SAML Response에는 SAML Request에 포함된 User가 요청한 URL 정보도 포함되어 있다.
* Service Provider의 ACS는 SAML Response를 수신한 다음 인증 정보를 확인하고 Web Browser의 Cookie에 인증을 설정한다. 이후에 Service Provider는 SAML Response에 포함된 User가 요청한 URL로 User를 다시 Redirect하여 User가 Service를 이용할 수 있도록 만든다.

[Code 1]의 각 Line별 설명은 다음과 같다.

* Line 3, 51 : samlRequestPrinter() 함수는 ACS로 들어오는 요청을 출력하는 Middleware이다.
* Line 12 : echoSession() 함수는 SAML이 설정한 Session 정보를 반환하는 함수이다.
* Line 55 : samlSP.RequireAccount() 함수는 "/session" 경로 접근시 Identity Provider에게 인증을 요청하는 Middleware이다.

### 3. Service Provider Metadata 추출

[Code 1]의 Service Provider의 Metadata를 추출해야 한다. 추출한 Metadata는 Identity Provider에 Service Provider를 등록하는데 이용된다. 다음의 명령어로 Service Provider의 Metadata를 추출한다. [Code 1]의 Service Provider는 "/saml/metadata" 경로를 통해서 추출할 수 있다.

~~~console
# go run main.go
# curl localhost:8000/saml/metadata > metadata
~~~

### 4. Keycloak 설치, 설정

Docker를 이용하여 Keycloak을 설치한다. Keycloak의 Admin ID/Password는 admin/admin으로 설정한다.

~~~console
# docker run --name keycloak -p 8080:8080 -e KEYCLOAK_ADMIN=admin -e KEYCLOAK_ADMIN_PASSWORD=admin -d quay.io/keycloak/keycloak:17.0.0 start-dev
~~~

![[그림 1] Realm 생성]({{site.baseurl}}/images/programming/Golang_Keycloak_SAML/Keycloak_Create_Realm.PNG){: width="700px"}

"localhost:8080"에 접속하여 Admin 계정으로 Login을 진행한 이후에 [그림 1]과 같이 "ssup2" Realm을 생성한다. Keycloak의 Realm은 인증 범위를 의미한다. 하나의 Realm에 다수의 Service Provider가 등록될 수 있다.

![[그림 2] Client 생성]({{site.baseurl}}/images/programming/Golang_Keycloak_SAML/Keycloak_Create_Client.PNG){: width="700px"}

Service Provider로부터 추출한 Metadata를 Load하여 [그림 2]와 같이 Client를 생성한다.

![[그림 3] Client Signature Off]({{site.baseurl}}/images/programming/Golang_Keycloak_SAML/Keycloak_Create_Client_Signature.PNG){: width="700px"}

[그림 3]과 같이 생성한 Client에 들어가서 Client Signature Required를 Off한다. Service Provider가 이용하는 인증서가 임의의 인증서이기 때문에 Off가 필요하다.

![[그림 4] User Password 설정]({{site.baseurl}}/images/programming/Golang_Keycloak_SAML/Keycloak_User_Password.PNG){: width="700px"}

"users" Group을 생성하고 "users" Group 하위에 "user" User를 생성한다. 이후 [그림 4]와 같이 생성한 "user" User의 Password를 "user"로 설정한다.

![[그림 5] User Role 확인]({{site.baseurl}}/images/programming/Golang_Keycloak_SAML/Keycloak_User_Role.PNG){: width="700px"}

이후 생성한 "user" User의 Role을 [그림 5]와 같이 확인 한다.

### 5. Service Provider 실행

![[그림 6] User Login]({{site.baseurl}}/images/programming/Golang_Keycloak_SAML/Keycloak_User_Login.PNG){: width="700px"}

{% highlight text %}
http://localhost:8080/realms/ssup2/protocol/saml?
SAMLRequest=nJJRb9MwFIX%2FiuX31I7TrJu1RCqrEJUGVGvhgbdb55ZacuzgewPs36Nmm1QklAde7fudc4997gn6MNj1yOf4hD9GJBa%2F%2BxDJXi4aOeZoE5AnG6FHsuzsfv3x0ZqFtkCEmX2K8goZ5pkhJ04uBSm2m0b6rtDa1VXd3VVLvKlOq7q86250V8LpiMu6rJzDVVdWx6MUXzGTT7GRZqGl2BKNuI3EELmRRhtTaFOY1aGsbF3b0izKevlNig0S%2Bwg8kWfmwSoVkoNwTsT2Vt9qlRFCT4poHIx6W1Bdwkixfsv4kCKNPeY95p%2Fe4Zenx3%2FKaT2BChxJsXvVeudj5%2BP3%2BZc5vgyR%2FXA47Ird5%2F1BttPv2ClqFu9T7oHnRS4nvitO06jFyJ6fZTuzZ48MHTDcqyur9rUVn6DH7WaXgnfP%2F2HPGSJ5jCzFOoT06yEjMDaS84hStS%2BWf3ev%2FRMAAP%2F%2F&
RelayState=cah6dnvLyCdBHc0bl5F2D3EZs1myEwIcGXHgrrgABaRtr0VVrx7ntLhu
{% endhighlight %}
<figure>
<figcaption class="caption">[Text 1] User Login URL</figcaption>
</figure>

Service Provider를 실행하고 "/session" Path에 접근하면 [Text 1]의 URL을 통해서 [그림 6]과 같은 Login 화면을 확인할 수 있다. [Text 1]을 보면 URL의 Query 형태로 "SAML Request"와 "Relay State"를 확인할 수 있다. SAML Request는 Service Provider가 Identity Provider (Keycloak)에게 전송하는 인증 요청이고, Relay State는 Identity Provider의 인증 과정 이후 Identity Provider가 Service Provider의 ACS로 "SAML Response"와 함께 전달하는 값으로, Service Provider가 인증 이후 어떤 동작을 수행할지 판별하는 용도로 이용된다.

{% highlight xml %}
<?xml version="1.0"?>
<samlp:AuthnRequest xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" ID="id-00c535d934e63f7519d60d1afbe4513cce7d13bb" Version="2.0" IssueInstant="2022-02-27T13:55:12.154Z" Destination="http://localhost:8080/realms/ssup2/protocol/saml" AssertionConsumerServiceURL="http://localhost:8000/saml/acs" ProtocolBinding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST">
  <saml:Issuer Format="urn:oasis:names:tc:SAML:2.0:nameid-format:entity">http://localhost:8000/saml/metadata</saml:Issuer>
  <samlp:NameIDPolicy Format="urn:oasis:names:tc:SAML:2.0:nameid-format:transient" AllowCreate="true"/>
</samlp:AuthnRequest>
{% endhighlight %}
<figure>
<figcaption class="caption">[Text 2] SAML Request</figcaption>
</figure>

[Text 1]의 SAML Request 값을 URL Decoding, Base64 Decoding, XML Inflate를 수행하면 XML 형태의 [Text 2] SAML Request를 얻을수 있다.

{% highlight xml %}
Request : &{Method:POST URL:/saml/acs Proto:HTTP/1.1 ProtoMajor:1 ProtoMinor:1 Header:map[Accept:[text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9] Accept-Encoding:[gzip, deflate, br] Accept-Language:[ko] Cache-Control:[max-age=0] Connection:[keep-alive] Content-Length:[16013] Content-Type:[application/x-www-form-urlencoded] Cookie:[saml_cah6dnvLyCdBHc0bl5F2D3EZs1myEwIcGXHgrrgABaRtr0VVrx7ntLhu=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJodHRwOi8vbG9jYWxob3N0OjgwMDAiLCJleHAiOjE2NDU5NzAyMDIsImlhdCI6MTY0NTk3MDExMiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDAwIiwibmJmIjoxNjQ1OTcwMTEyLCJzdWIiOiJjYWg2ZG52THlDZEJIYzBibDVGMkQzRVpzMW15RXdJY0dYSGdycmdBQmFSdHIwVlZyeDdudExodSIsImlkIjoiaWQtMDBjNTM1ZDkzNGU2M2Y3NTE5ZDYwZDFhZmJlNDUxM2NjZTdkMTNiYiIsInVyaSI6Ii9zZXNzaW9uIiwic2FtbC1hdXRobi1yZXF1ZXN0Ijp0cnVlfQ.oopqK9Ss-gpn_c8OegyIteY7FdIgDhvnd45ogbokbdeHKnUkoorQ-gbAvKbADcIJAAgChu6hU8gD9Cvz5smOpGc_gaFEL0O5Vjpsu7vNLmHxEMiTgJCWWe_vx9THq0VqXif4zANKTpabRMYNf0XLDH5D4Zf7sVQGdDKovKOd4ww89GXy8ImZx0Qvbbcqz45If6rJhPqMJMkNhwYjawttUiHyBBXAFp3u4Cm8f2ujGzSN_LK4J_HYwLmo-ufq9-hy-eKmn5Ji2qM5hkpzZ0N2s4d_IktIvX4rHryOCo8nktCBPYySvVLZ8sBLLtBjFKjQ6MVhkesUbwQWGy_T48R3-Q] Origin:[null] Sec-Ch-Ua:[" Not A;Brand";v="99", "Chromium";v="98", "Google Chrome";v="98"] Sec-Ch-Ua-Mobile:[?0] Sec-Ch-Ua-Platform:["Windows"] Sec-Fetch-Dest:[document] Sec-Fetch-Mode:[navigate] Sec-Fetch-Site:[same-site] Upgrade-Insecure-Requests:[1] User-Agent:[Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36]] Body:{Reader:SAMLResponse=PHNhbWxwOlJlc3BvbnNlIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIHhtbG5zOnNhbWw9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iIERlc3RpbmF0aW9uPSJodHRwOi8vbG9jYWxob3N0OjgwMDAvc2FtbC9hY3MiIElEPSJJRF9mMzE1YjA1Mi02MGMyLTQ2ZjUtOTUzNi1kZGE5MDM0ZTcxYWIiIEluUmVzcG9uc2VUbz0iaWQtMDBjNTM1ZDkzNGU2M2Y3NTE5ZDYwZDFhZmJlNDUxM2NjZTdkMTNiYiIgSXNzdWVJbnN0YW50PSIyMDIyLTAyLTI3VDEzOjU1OjQwLjMyNloiIFZlcnNpb249IjIuMCI%2BPHNhbWw6SXNzdWVyPmh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9yZWFsbXMvc3N1cDI8L3NhbWw6SXNzdWVyPjxkc2lnOlNpZ25hdHVyZSB4bWxuczpkc2lnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj48ZHNpZzpTaWduZWRJbmZvPjxkc2lnOkNhbm9uaWNhbGl6YXRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz48ZHNpZzpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGRzaWctbW9yZSNyc2Etc2hhMjU2Ii8%2BPGRzaWc6UmVmZXJlbmNlIFVSST0iI0lEX2YzMTViMDUyLTYwYzItNDZmNS05NTM2LWRkYTkwMzRlNzFhYiI%2BPGRzaWc6VHJhbnNmb3Jtcz48ZHNpZzpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZSIvPjxkc2lnOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIvPjwvZHNpZzpUcmFuc2Zvcm1zPjxkc2lnOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3NoYTI1NiIvPjxkc2lnOkRpZ2VzdFZhbHVlPm80cGxhRGd0MUxUTW9xdXBaYUM5a3ErODVNYkdKSDFqNHRIMGVUZ21BSE09PC9kc2lnOkRpZ2VzdFZhbHVlPjwvZHNpZzpSZWZlcmVuY2U%2BPC9kc2lnOlNpZ25lZEluZm8%2BPGRzaWc6U2lnbmF0dXJlVmFsdWU%2BWHVjclJmNTI4UkcyNXIxOUVSb09zOEhFU3pCdml0bHE2cW1tKzdqSzZONEdRWktVSkVOa0ZTYy9xdHJkWXR0Q1NWK2E3cDdFTDJzY3FRUFJKYld1eHAxQ3NCUmN2YmxKanRnc05ubVZBWG1MWWtFUUlyWHUxczlnMllQNmlYZi9xN2k5dnJkVTdQTWpoc0pTVld1NzVVVUZyclF6NDViSjJxN3lsd0gvSzdpcmh3M0YzcERDbVNKek9qckZyRXFFVHRDQkQ2SG9TMk1SU0FJbCtEbnlvNkhWbzB0WHhXVTA1N1F1dnJYUU44dG5iZURTZ2dEMXNVZ0tXb2xXajN3MFhwRU5zelkrYXRpVGZrNms3R1hUQUxZeWc1eVFvNkVkN01VMjJjR0p3U3VRU1VaOVVpbmQrSXV1bXJUTGllQzFld3A5WTJUOWpDN290T2FkVFR3VlFnPT08L2RzaWc6U2lnbmF0dXJlVmFsdWU%2BPGRzaWc6S2V5SW5mbz48ZHNpZzpLZXlOYW1lPmtaTDR5d1Q0SExqRXhjN19HZkduNXVvYUhZeVk2YW9hal9nNDRlQlNvVlk8L2RzaWc6S2V5TmFtZT48ZHNpZzpYNTA5RGF0YT48ZHNpZzpYNTA5Q2VydGlmaWNhdGU%2BTUlJQ21UQ0NBWUVDQmdGL0hMR1c3ekFOQmdrcWhraUc5dzBCQVFzRkFEQVFNUTR3REFZRFZRUUREQVZ6YzNWd01qQWVGdzB5TWpBeU1qRXhOREk1TXpSYUZ3MHpNakF5TWpFeE5ETXhNVFJhTUJBeERqQU1CZ05WQkFNTUJYTnpkWEF5TUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUFscGxyZEVneStBODNTaEI1K3lQbFg3TnRGQWlTMGFsbi9acUdGU1pZaGQ0cFRUTTVOUzFFalpnVThvRzNUZko5ZERsVUVCQTQ0aGkxbDIxYmljQWVqRklCWENVaWZqa3VTTWxpWHNHWWY5ZGpFME03eDZWTUJTWkNVYUtLdno4LzFEOGtYL3FKMnN6V0tzbUI4VmRSN0hLYmIyTTd3bWR1K1BkNDJGd0pBUmZoUkZZR29ZSDBnVERpa1UwbDhRTGRiT0FiNE5PQldnYUExaDZCWG84RlFhUnJrT2lsMFMxUnQ2L2R3Nmsvay9xSHYvcG1TR0I4VjhzbjRPaHRLM1ZLQy9ORmNLdFBKRjV5NURBQzRkOVlHY1NnYmh6aFV1ejJuWjdkL0hzekxWQXRadklVa0lwM1RkZGdxd25WVEtFTDRUK1ovNG1hMWYzUUNJeWFFUWlNQndJREFRQUJNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUJGQ0greUt3R3JUd0dTbFhYUDI3ckUycnFqU0lZbmt6djBuYStvQ3VBVHhieCtZbkNFaUtuck5UVCtoVWdnYlduczFWaGFlUEZLbnk4bWdQUHJTRno1WEY1bVF0RkNZMXQ5L2tXTVpEVC9Bb3ZpbW9pUFR6a3lxdi9LT0hFMXhnUTRIaTdGeHdrMlROdkNKK1JlZjI5a2M5WEJ1eDR5STkrZjhVZWNNMDl2RWJmbFRMVU9hemEwS09aS0ZYYnVJUklxSlp4QUJQR2ttT05CNkp3NnpUSWdtYjkxaU1HVm9TZ0JUV0xEbHA1RWtiZmxaYVpJU2szbTNOelQ4Nkl5S1VpOVUrenVvTG1lS09GbExTeEV5YUN5QVp0aWlRdnVwVWpDcWZ3VWY5enR0TWNFNjNOMFpQUVhhMko2bW5pWjJoNW5lQmRQRWlhWHpsOGR0eU5aNHpmTzwvZHNpZzpYNTA5Q2VydGlmaWNhdGU%2BPC9kc2lnOlg1MDlEYXRhPjxkc2lnOktleVZhbHVlPjxkc2lnOlJTQUtleVZhbHVlPjxkc2lnOk1vZHVsdXM%2BbHBscmRFZ3krQTgzU2hCNSt5UGxYN050RkFpUzBhbG4vWnFHRlNaWWhkNHBUVE01TlMxRWpaZ1U4b0czVGZKOWREbFVFQkE0NGhpMWwyMWJpY0FlakZJQlhDVWlmamt1U01saVhzR1lmOWRqRTBNN3g2Vk1CU1pDVWFLS3Z6OC8xRDhrWC9xSjJzeldLc21COFZkUjdIS2JiMk03d21kdStQZDQyRndKQVJmaFJGWUdvWUgwZ1REaWtVMGw4UUxkYk9BYjROT0JXZ2FBMWg2QlhvOEZRYVJya09pbDBTMVJ0Ni9kdzZrL2svcUh2L3BtU0dCOFY4c240T2h0SzNWS0MvTkZjS3RQSkY1eTVEQUM0ZDlZR2NTZ2JoemhVdXoyblo3ZC9Ic3pMVkF0WnZJVWtJcDNUZGRncXduVlRLRUw0VCtaLzRtYTFmM1FDSXlhRVFpTUJ3PT08L2RzaWc6TW9kdWx1cz48ZHNpZzpFeHBvbmVudD5BUUFCPC9kc2lnOkV4cG9uZW50PjwvZHNpZzpSU0FLZXlWYWx1ZT48L2RzaWc6S2V5VmFsdWU%2BPC9kc2lnOktleUluZm8%2BPC9kc2lnOlNpZ25hdHVyZT48c2FtbHA6U3RhdHVzPjxzYW1scDpTdGF0dXNDb2RlIFZhbHVlPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6c3RhdHVzOlN1Y2Nlc3MiLz48L3NhbWxwOlN0YXR1cz48c2FtbDpFbmNyeXB0ZWRBc3NlcnRpb24%2BPHhlbmM6RW5jcnlwdGVkRGF0YSB4bWxuczp4ZW5jPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyMiIFR5cGU9Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI0VsZW1lbnQiPjx4ZW5jOkVuY3J5cHRpb25NZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3htbGVuYyNhZXMxMjgtY2JjIi8%2BPGRzOktleUluZm8geG1sbnM6ZHM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPjx4ZW5jOkVuY3J5cHRlZEtleT48eGVuYzpFbmNyeXB0aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjcnNhLW9hZXAtbWdmMXAiLz48eGVuYzpDaXBoZXJEYXRhPjx4ZW5jOkNpcGhlclZhbHVlPk80YVhzZ3FuL0lSQzJMVGVoVU5OeEJDbmZuWXFsNDA4TnBhcEUycTlkWjBENzlQZ2RvYk5DVnVrNEUxdi92NGFRVzA3Sy83cUZES1dBL3RZV29JUUJCK1dHL0ZxNXlPblVuWjNxTUZxYWdjMStSZmQ4VDZSeWc0M0VaL0ZLWTNOQVphNzRTRnljSSswR2Z6L0VjcUo3K055REliQzI2dFVuQVVCTkF1VEZEZ3hvK0JReVpOQkw0NzRKZ0JhUjN2aTZ2Z3Rjb3pwN1VjTUNSYmlYQXRXVVgwa2cxNGpUaDNlODdudEMzY1JDK0dKL2hMZ3hJUGxHRHlZbEQ5Rm11d3g0d0drM1UzVFNRU01qOVQ5ZUI0UEV3S3E2LzMyZktLaCtGaityc2hQei9oM3dOYmdLbHB6WnlBV1hyZHFtM1dnMmpZZk41YU9uTjQvdjJBQzZ5TXdpdz09PC94ZW5jOkNpcGhlclZhbHVlPjwveGVuYzpDaXBoZXJEYXRhPjwveGVuYzpFbmNyeXB0ZWRLZXk%2BPC9kczpLZXlJbmZvPjx4ZW5jOkNpcGhlckRhdGE%2BPHhlbmM6Q2lwaGVyVmFsdWU%2BRVdaOG5UWWZvT003blVUNk9RSUpuZHpZWDQwTjBIQWVJOVp2R3NZN09iZmFqWjJSeVJXd0lDVzFRbzhuTE9xeEVoQmx5d083OUlHUmZNL0FHa25QMjgwdTc4ZVpZa0xaRzB0ZXBHZ25KMzh6VWhPcEFPd1RVbmhoc2NLN0FHSVFwUS9nM20zSjlTTTQzVGg4QUZhYWhDelRiTXZBY2JPeWlUUmUydkNiNUxpUmJmMm9HMEhXKytXeU1ZamthQnN1VElmbmM1MGtRYnZsZ1RBbjNoQmZsZjYrb0VjWjdvRmVZbG9tc3RqcXY4MWVyQ0x5Vk42akNPY0hGVmJXNHJYaWUyWFRzQ3I3VTFOYlBQdXJ4Wlp1Zmg4emY4YkhnR0pRa1pleVYxemRDY05jSmUvbEJTNWEyNXY3Qk43ZHFvUVFZR3VmRnRHNHhWbkIxSzhnU0VlWk0yWFR5Y0dvMlI4RlJTWXRUdnVxVms5c2NGS1FlTi93SEJVZ2ZyVlVHRUtpQ3YvbktXb003U1lUeCtTb2twR2N6anVsd2FkMlJYemw3Zy9Fblo0U0NCbUlDZ3lYU2ZYVWdIUUkvaXZuSDVNTHNMZXI3RDhkVzY3YmZkeEluMmIvVFBCejFIUkg1bVNOMXRyTU1tRWVCWHNKTDFqVGYzOTZuZHo0UmsrYnNRK2NldVpPeGQxcjdQcHVmQVQyWm9Qbks5UXlSNmYyT3VpUHBGZ0Mzb3huVXRiOXBDTG5Ta3Q4U0tzWVNvdnI2bnpMZndlNUJ5QjZ6Q01qZys0dWgvY0hMK2JleUFZS25SY1NVa2Z3NXFMbDN0Q3lHcHlFMzZvR2RzMVlhVVVTZVRyUmt0ank3ODJET2h1TWhQYWxMeXRqWGFITVNZS2RhNUU5RmZzbWsvbWoxZE1zcGx6dFVlMUZlMHJ0blZVL3JxSHBKUGFLOTZZZGx1R0NzZGZrNitDeVVsajlGODRnSzNZUnh6dk9sMjN3bGJ6S0NmRHFhRWZHUE9Sek11eFJCZ040OENZbm5xTFBxMHJCK1I4THBUNXNxRGlXUEpHV0Y2VnN6UGNkYk1ob1J6bnV2aWxhckpSYVJMOU9rMGJYcW9VV0w2V0ZGM2xEbEJzL3dJeFVRQ000YmhoRkRMVEtoakx5RC9zcDAweEFuL0xGQUJOSXpGSzRzdWZ5aUxhdktwaGhLQUVsVThXSU1oK0wzazhIZkcrVFJOdmlDaVVWS216TW9CWnlsY28xZUtpdjJmd2F1cE9WdW5OdDNhVGV5SXk1TWVDN3AvWGt1aFVQQ3haWW5EWnZ1bm9nM1k4aTVkZUpZNjJFNnpsYTIxMzRFR3V3WE1oQk5sbXRwT09heS91c2ZNeGkyamRIQWt3RVVXazA3czhIVmdaRGpRMEhYTUdzWTRmSUtGVVdZRmVIRUJBdDlUM0VDYWh2TkNGMUU0TDNaTG0zL3EreGVwc1hmZFFHSXlZM3FXRlk4b0dFeXZvcGdIWk5rZ0g4ZENtVXc4bzRidVVOSE85TVpKblY2TmQ2ek02UmUwWHphd0prSkgyNStQNWhUNHRMdzN6djh3VEE2b0h1aFdYcGZ3YkhhOFlvME8ydnpUV0FOdHl2SVlGTUVJdXZHUlM1WTlLQ2lpRG9qNTY2M1pDZVBieXBNM2h4S3hZU0dnRWFQNVNXYmQ1RytoS0JUOFdLNHQ5Y3ZCa0lYME43T1MzQ0tyaDBZd2Y0V05zRUFDbkdCWWtQUlNWY2tCZnhKQnRUcU4xZDIxTHlYb3VkL01Fdngxd0hpVDE5aXNQcksxN0k2WlM5UEFmUzdFbHRXSS9tUjBmc3VtemFjVFoycWZBSlE1YUxsVzRqYWtTZXVnd3VSZEN5ZWxzR3Frb2RNRisrQ2lOMy9KYS9LMFNOOHlnR243Unc3c09zWlB5UzcyTElUMnRiSURONmNDNUNwNzBDb255MXpDLzY2N014YVBvY2QzSktNN2hSd0xSQVpCK0dwVlVEYWppN2lmNitDTXYvaEczR0xNY2xXYUtDWkpKb0VzeURnNXJ6OUJJUVFPN1A1aWllaitLQVh6YmlEWHdWbEplZWVHYlRHeEZaeUVhZEdBSWF1YzladjZnUlRBbjJzaUo2dERuVmViRUNMcis5RmRxanRPdmIzUWdhNmRFRk1BOVRiVXFXUkdXeC9nVTVOWnduazNFVkd4UkpGbytVaVU5MWVtSGpWL3MxZnBmTmpVNzIraFpqNHN1MEVmbm9WZTYzVm90Rm1LR1VnWkJsL0pCdytZM0owQk1oaWZhWVNQMFhsOUlwNU9QWXdkZ0pKeCtWd0M5bHZYc2ZBU0d2K0Q2cy9kRXVEZFFIZFh1dDBPMVUxUTdzQnl4dVA1bjdyTktjbUN1RDVQNmcraWdOaXpoc1I5KzBvUndDSnkvZFZRd1BzRld4Y203RlJ1YmxYODZncS8xUXpXK290MWtHbzVzcDNzUVR0LzZkNjhxYklkRkZCOEcyVys5SndWQ1hxb3VXREQ2amdmU1lOU1NlUklEYVk2YlA5TkVLNUYybE96QW9mc0s1Nm9CeENLV3Z6cnhtVFRJQ3QveFJob1hHMkphRkZxTi90Q1NPUThCb01yVFRQTHY4cTFZZEQ0SStxNG1xNzNDUHRveVBNY1QvT3F3T2FZRElkOWdTWUFDN2hTMkc3dFZpaUZmYks3ZFpiTWFrYkRIU3BPeC9hQkVBWHZWSzlJZzd1bWhhTjBEeTRyNHYrUlJEVnZ0ZFJaWHdLZ3pOUFJlV1Vrd2l5b3oraXAwd3BUSDk4MDV4dDk4TUFqZW8wdkdtakNXTEdMcjdzcDJQN3BYRkNxTXVFc0tUYWZ6YWREdUV4TG5LNnIwUzNBLzd1d1VaOXN6Vnd2N2N6Vlc2R0dYVDljM21tQjFoOEppUzRHblQ4NVROLzhiZkJrYWRYQ3pkWVIyVjJJU0k4Mm1YT0VUK3VPR2VjY0d2cmVtajBDcFdZUUVuUHRONGQ4MHA5L3dsYVZFUDVXaU1ZakdhRTlnUXB2TFRrcnZwRi9tYXY4S2tFeFBOZ3p1ZnFsZWhpWlhXM0g4RXFOWUVSUENjcVRYSmV0UTIxcENDZW1ZQkNEbUlyVVRFU3JPWGVkajVVaFlWeTZld25ZZ1I0Q2lCOWRBS0dqLzdaZmhTdFNYeE9pV25TRi83WFI3KzVUbE01ZVE3bis3SmhjVU9zbTRQUnZyTi9yd3h0SDRhcXpvZzZycmkyalIwRWplK2dka2hBTTE3c0JjZU1KL3dUZUVFQTE0OGZ4MC9BS3N0aURjd3czcUdPeFJmQ1J6U3BBSW55NEJyN01SbURDRW0venRkQW5mWEhHT1ZFVUVWOGZOUVo0c0VPRENXQ0ZFUmJhWTlqRzA3eWhETGlINXpvZjRGVWNIakFNR2NXbGdVNGlJWnMxNm9uTlorTWRNSWVTUVlUREhzZUxWUHIzazdJeThRdEpqdWpBQWZuTVl1SDByVG5QWDdFRStqTmdNT3VtQmRBMGpWaTFGbExMTFZYakdBaHpRZENDY3A0dVI3VU4rM2pXS1RVek9oL2ozV3dTSXRPazNRemhMM3pKbmswa3JyUTFvcmhHVlpPSC9kMG1qQWc3aDV0bklUUVhLc1JOajBiaXNqdUU0dnhHQ21sN1V6TUEyZnI0bDJmOG5VM1FRSTlVOHJISGdQdTMyVjh4a1djd1VFdTZVTXdlWXU3SExxQUxjTFdDU3BhNCt0TC84RUZ6K2NOd3JSZVNkU08wTE9EWnF4NytVU0pENytSMHZ4L0NiUWlLeWFuTGV3YXRLcE5UY1pmVUlPM3NFdHNBUjdNMENFRmZBczJUYzNaOVNUZTNDbkY2dzE0Ty9TK3p5WE41QnNnNmdhTG9TdFpNVnVERGQveEpxRys3MUt2ejREWHJFSVF3WEQvL2JWMm5TcTNPblVvQnJ5d0Jhc05BOVlMcThiT1VTejBJbU9YZHRyUlkyay9DNGlFVnp6cXR0aDF5MkNGRmQ5bW0xUVk1aHhUSWZQZ01RRmhucHRJSnFYaWZnYWc3N3NiRjFXajJOQVdDaFdIUFJuOStNOEZuZ3gzTWYrdmZXTCtjVjVLTmNGa2xYQWZMUlNTUzFnRmsxcXdHWG9WODJwK0x5Sk0rMWxVUWdQV1YzSTVQOWkzYWdpKzEvY2VWRkhwbXdqb09oWUpqcFNqeTFxTFQ5Y2dkWCtXVTlHWlRnajNIbm5aYWpMUHZNbUprMEZVc29aN2p0ZGpvKzB4ZGZBQzBwMzZ6ODVXUWRpYzVqVHBsQXE4ckw3M3JhMC8vRWd1N2U1OE1CSEgyaGxwdkFHNU1rTGFZdllaTG9IRWRMT00rRWFSNVIrZy9nTDArdXNFdUZ0TVQrbitDSGZ6bjRoalBEQzhJeDlrdmpoTHNnakRMZlowYlN6SUs2Sk5GdjdiUXpNZ2pUS054MXRiRlFCeUhnRTU4NHh2TklBZnNZTi9lRDNheWxURUxONzB2L01PVkZ1Z0xzWTJKbm5xT2xIZE9Pckh3WGR1K1U1cHlBUkNqQmU0YUJVTmw0WTRuU05TQlUweWVFT3ovWUkwVDJCb3NsZGFuRnFOMlUzZytnWndiVUttK0xxeFlDOGxVNFViWUtkNGJORksycXA0d2VWdnk3eDQ4ZHM0dCtmbEpMU2pCakFNRTY5ZDJnQjFjWDM0ejZFUEVidzJOc29vKzlwQ3FlczI4OHBnYXE3UlRhZHl0Y3h4dzBxbnhid3BKcnlyOFVUNWtHN2lFa1d2NzBUUkF0K3MyQmRWVTlRS1VHMklja0dpbWFHQUhqSnROOFFhd3p5OUpIUkFoelZjY0V2ZllDZzBWSWFhOXhvdU1nY3ptR043Y3I5aFJ6aEJ0NjV6TFhuT3N3bTVVMFBmaDJlMnBETmxhOEE2NGVjRXZneHEvOVV6QXN6U0VCUW11bWFhaTk1aXowbXJtTXNIRnJ5OVhGNzZuc3ZHNnlFbzdJVnlONlNhamljVDAyNUpDZjhMSXYrYTNJVlhMUnZYY2lrc2MyMHI3OW02N200UVhKcUJ4NFBVam1UMTBQcEl0cWpldTBsYlVkT2oxNHBwQXNTc09xMWNhZWFHaFEyY2ZXWEo4d2NncXhTZ3ZYSUpVRTlKQXRwUnEzUUVYU0hUTmFjOGU3cDhLVHpuV2t5LzNCZnZ6S1ZaUlQwRWtYOVdXTWduelVPK3dzRThvUVNaeVoxUFQrUjJwVDlnRUc2SEJvK2lLWGY5UnpoRmhtRkNGRnZCV1B4WVdzSmpLaVpNVUNEeGdPeHBIN1FpcDFQZmphN3o3eEdHUW5lN0xBZ2s0UHlzT1F1UkZ4eVpDbnB2OFI4anhtRWM5ZVlSclJnS2JKdzBsdnpmMnRNZzdLRDhvejJ4K3RwMFZDZFVFaTBzbGZLTXk3Tk9FVHNmU3J2L09UYitMcllZN0IxYnE2dkpHV1ErVUpuRzBLdmxOaEZreVZrbkMvUTc4czV4N2dKZFFrVHVHbE9iekVJckVHOEJKdFZESE44UmpiYzFCb0J4YlhMa0dudWtIZEpSMk1IR2Y3M2tvOHkxaXJkNFdkMkdYU01UU2pDRkR4WlRGanFleUFHSEVQL01hZ09OVTQ4aWhjWDAxbUQzL1l6UEVMU2RyQjZ4NEplamxmaEkrUTRjbUdud3NTaG9oOFArSzRtbXI3Nno2QjRZRkpNZGpDNTBMZSsxSjIwUjhuaVNoZ3EyS3U5RkttcERpMHBIY0hPQUNUZUlJRFQ5ajlrYlRVMW9QL05kVkoxRFNINXBPLzlHc0VBQmtRQndVbzMrY1BxOXJBakJuOWdSaGNmdVJJc2ZsZUE5K3BCTmxONm5JS2g1eG5LSHFSc1ltOGZ0Qkwrc2YvUHdHWEJvT1BCd2FZcHJsVXQ1dktOV0pIV3grSVY3Z0lQQWx6aW9zSGt6Y0JzUjVwcXdiODBMVDlVakl6UFhGRDVVT2I5NWd4NmhUSXg2dFhBWFBuMGlyVUV2b2h4QmxaQW5BeFliQ2lNQzRqV0lSWlRIR2RiVnpJU2NsSGV0U0M2RkpyRTQ4eVVVMzRTY0FpakxqWG9iM0RoZ3hnMzFqWjFpd1JYakZQZFZtbTR3UEpYODBjSWVGbUtWSjJJZ2JMMHNESCtCS0x5QlBqbTNqYzRlQ25ncnEwRlJOcVJsNEJ5ZjF5T2xTdWQ0Y1hBdjBJS3JOVEtnaEptUWYvemczUm5CNlNVR1FzY3pEU0kya0s3T3pJTHdScEkvUWZodGsvY2NmR1ZpMnZLYUJJb3ZkRWsySDdET0Z4WXVUdXd6ZFRCZlpqbnBZaHkzbTZzY1g3M1p3d0w4Rk1yQnIyUzZJM2lBdUdRSzVmVUVFenpMYnBtMzgzVVc1NW1kaHYrTVFJeU5oVFJUK0tEbG5lcERpNXpWWERuSWpFQnJtMTlXK1ZLQ2VEcUR6a01hWWR2SG9CWjB4ZEgwTVdKbytvUjg3R1lzYVlkNDYwRlZ5ekd2U1EwZWV4Y3NqM0xoMW1Mb1pjdExkTk9qSlc3T3FRLzJHdjZyRHRqaXJrWWx3SDRoTkc4Yy8vbWkxeWt6SVppNkpoNTVxK0RNU0hqbEkvbFZBeUJFSlZJYUlzRWpXbDVnZWhtMVJLNmVIMVY5VTVSSTM0bnVHNFVwVGI4dkx0bjRzdEpBTUxOVjIyd2xGa0N5OUFzWnRBRzMrdkZmb05mWHVVQnRjKzdLUFAxK3pWaFNQV0s2V0oxeXgrdWlJckhIdTdWQXhYTVdzQXdTY1VVS1lGTFhMRXVEbGpmQkpWKzBNZXdlMUgwREVGU3RRNlViR0s5OXVBSGJkem5OM3JldXNOenRpNWFEOUorVlhBUE9iWjFHYjJRamdPb2MzTDNMRUgvaldvZTNuVkprVnNZWVpHa3ZNY3JvcXBlWW5lWlNOby8yYk42eENKUmQyTDB6OVIxaitNRHBwR25zbStMaEYvODFYQk5TNjJsbTFSY2N5ZTlsOHFTWk9BZWxmNFN1YnNseUJQRWg3Zm52Zkl5dmJvclgvcFphcUV2cXBsQ01ZczdWYjFRbyt4ZUt5cCtkS1dRMHF2TmhscmNsb092QnNKekFvMW9vK25oWnRvSWVNK3paTVB3S2tFWm85cHZtcDNNSUlZMUNhaFIzQjJPQ3JVZ3VDTy9QMi93TE0vbE5DVWZNeHk3eS9uU1gzeTZsVHN3QlkyNkxvK3V2K2tkL0w1Q3B5cWlSMXRxRUVFVmZkcmo3dkc3amFsMXBPRURObTlRN0VvOEdRMDRjL3VCU29nRDdWNm9YSU82c0kxajQvWmg5dUFKdktxa0xndjJkQjNyTmdXWFJhd09UYXFaTUx6Q2RVZFNoTGk5V254bWJQelJ2ME1kR3ZUK2VMQTlwSUZVNkYrYVJPZml5TXZ4QUlkUkxyaTFGSzhNYTlQZFE2VXY3eFhUbUszYThXNEU2dG5DZkdSTzBTWlY5Uk5PWGhmODB1SDc4UlJQa0dXRldYZHprVlU5aGI3amU4dERVRHF4VEUzRk83M2owK2piSHNJYXJZdTc1amtvcU45QmQ1VjVrM1ZwYmZYekRPTVdmRnNqcTBRaDdpbllORzBzbEVwYWxJbnFXdk1uV0c0MDNMenRYRWpTRW85YzlpN0xLd3lXVkhkN1UyWFRUTFAzWFlJNFlTNVc4ZWxSekNmeDRzaUNwNUhWMXU4UlNJWEFmbTc5d1pVRG9QMytLR3cwR0k0alJXRUcwZ21Td1ZBMmVTK29hYk00cGl6a1VhUm1qbHlzcWZQTFkxVEo1Q2JZSHlBSmZRajlCT2tHVXRqUWVDbnJ6bVEzeXlIY3dHMmFpTmpJNSszQXUvUXZWVUJPZXJqQzZBVWlEaDBnUWdNQVRaaTN5QWdmOGZqbVc3WmdUcWtXZ2d6VVIwOHpISk8wc2V0UGtBa3VJTjN6QTlpMk5vNlQ1ODJIUk1xWVV5WnNyUnRVS25lSFlURE5BS0w0cEhTRllDTmlWdWs3eDRiUHAvbEd5YnljSWxqTmNDWkhnWWk0dHB3Nk91RXNvVWtFcmllWVhmdkNrejZLL1MzSXhiS2tkaUZ4OXhkb0ZNekdUZmF6eDIrVXdwcXNrejYwZFk5K0Z2bkRpVTh4Z1BVbUVXSklqbTA5dFp5b1ZHckZvRU42SmZLbDdnRlFOMWFiTExIZTlMUzVqRkpMSnpBY05FcEI5N1ZFNkZORnJzOHlFaG5uMGdPMHI1QWxMdXZTSEVINlk5czIxZ3NiS2xnUjRBTzhBQndBK2M0emRTQk5SbmN1c1ZVT1ZYSHlVRFlraTRRLzBseXdZSnRpY1FQVXBlOXVNYTFUUjdxdjRZak02L3pBVU9Sam9rWnhMbVhMUDNmY0VETHRmVlpVQnB3Y1crR2Q4MlBVSVljdlN1TmlWTTgvVThWN1pWbVZCbmkvalZRZiswclA5aWZGYythdDFCNEh2NDh2b0JTZXNjT2F5QUw1dlNqSkJJVWtqekY0Y1d4M2IwYW9rUWxrWHNZSmcyeHBRRFBDV0l4ajJMWmUxSUN4Y1FmZk54SHAvOCtWN2V6R0piWW9HcVpTQWdYZWtPZ1hPeCtkb3hJd3FHT0hYbzFYbkFnZDVYcGJsQ0hnTkFvUnlWNUVtWERvQ1NHVklMSkgrNStHdEdFL2kxUDF2VzZCbThGc3h3SHJySlo5bnVtejl2NnhaeTRQaVpHVzFGSVI3dlpTVHhPTmJsdEltM094M05GeFV5akJjcnpnVmFCM1M4SzltZzF3SmdBaExWdDBnTlJMUExOMDg5d0FDSllSc2JHNE1rdzRyUVdaQnJ1YU1wWXlOV2FsdkdaVWRETUFQQlRkZWhWVWJzTzU0YndLWDdaVTMvYm9adENSVDVBc2RVeVFGWnMvbldtanJsS0g4STE2dXk2bEJ5SEIwME1qWlZPSC9nZU53VlpOY1IxNTF5RzE0b1Z5TVZ1QUVWeXNKWThoTEcycmR1US9aUFVVb3NRUlVjUGg3TGlpL3RGTjhCcmlxb1hPTGpSeDhPTWxIb1dlUnliYWVROXFoSURoUlAvZTJCZThlUFVVR2QxYjBEbEZydndUby9ZNjFIYTE1a1A2RTlCcXpDK3VaQVpqRXhhVXV4NGFHVlNzekFtYW1pMjNlUXJUcUtEV1J6dUZjL3lLMGd5NVVJNjhDRS9YVVplUlJaOHArZlRDNkVrMVBmZTFOZ0RtV3hIeWVWTzZrU2RYOXRJczAxVWJlRXVGcjFwSkdpT3JOdDVlOHRwOFJtNHMzZzM2WGFMNlQ3Z210WnJPRElBT2U1a3kxcS9xK0pRUjhjVkdCcENiNk9BM1k1SmcwdGJ1cyt1SW5UcndaNWhjTm9LeEp3RHNmd1JoU0ZWYXJuM0k4Mk1jQjNzYlE2Vjc4MTZMdTRFVTUzMHQyTUN2MXBQVEpPM1Fyd1RWNUtXK0lMNFZxbTJwQlRmbkd0MDZvR3NzK2p3WGJMSklRdHhRSFJVenI4N0NOdmVUdHFSUDQrOTFSTlhWWUpUbkhvV2hES0NEdmNRekxBY1VBeXcrWlVieVdLcXRRRGl5SldaWU9OWUNNaEhsNTV4Ym1UVzBpWE9nTjBPOTljYW8zVGJIR01DZGFiT3pNRGFKbjdkVzdmdWpIbU1GdFdkUHNzanBlRXFWeU5QYVVFRWQvUWVuZUlrWFZBeTFxRWJaaXk5N01uZTI3bEs2TGN1bkFWRjM2RmJ0WWVFQjNRL0l6QVlkS0hDY1Q5Y2thcWRJS2RORE9xMTNzQUkvSEw1NmNRT0VkNlUvbGx4cUtaRXBzcDlsSnVhdlRBMXhHRTRicmVRMUcrUjVlTjVuZHdjNGZMYjh5cll5QmdkNmlNc0JxN05LQTkvUUZUOWxoM2ZBTDA1Z2JkakUzNE9NMnpyVS9aV2dnbkNJT3lvamtTaWd3T3NJaGxlb3RubTA5UGg1NFV1MTdwUlozUVlNL255ZktKSnA4ZEpmUXdXb3R4UXdTZ3lBd3ovaS8weGFCOGY0akhlZEV6Yy93Tk9ObWlDTFlYMnViUTE0dDUxUzhWRGhKck9yTVphR3ZIT2pCNTJIc0pEazNDT2h2ZlExSXlHQ2hiVUx3clk3bUJybGJRQTNjVCtYcnVuNis2TXl6VlhpUXF6Si9HV2Rqd0szUXFYRW9HbXlUQUw1N0p3dWNNaDJ4OERkY0lvemEzbFJXL2lJbHAyWXlzMEV5Y3pqeVMwRkMrN1ZETVNDS2tNTGdnQktHS011SW1razhnZGw2MFFGMG8wVi9JbFlTY2JUbzYxU3BhTmtaTEVtV1l4NmNLZGFHMVduUGhPbzlPaERHWGowMXNQUFo4MTFpNFh4T25sZGN3VmdCOG5la291SnpyZjF1dkF4Y3htWGpGbVdDeURIbmdpdGl4RkNuR3pOR3ZNL21BPT08L3hlbmM6Q2lwaGVyVmFsdWU%2BPC94ZW5jOkNpcGhlckRhdGE%2BPC94ZW5jOkVuY3J5cHRlZERhdGE%2BPC9zYW1sOkVuY3J5cHRlZEFzc2VydGlvbj48L3NhbWxwOlJlc3BvbnNlPg%3D%3D&RelayState=cah6dnvLyCdBHc0bl5F2D3EZs1myEwIcGXHgrrgABaRtr0VVrx7ntLhu} GetBody:<nil> ContentLength:16013 TransferEncoding:[] Close:false Host:localhost:8000 Form:map[] PostForm:map[] MultipartForm:<nil> Trailer:map[] RemoteAddr:[::1]:43304 RequestURI:/saml/acs TLS:<nil> Cancel:<nil> Response:<nil> ctx:0xc00030a040}
{% endhighlight %}
<figure>
<figcaption class="caption">[Text 3] Request to Service Provider ACS</figcaption>
</figure>

[Text 3]은 Keycloak에서 인증 완료 이후 Keycloak이 Service Provider의 ACS Endpoint로 전달하는 Request를 나타내고 있다. Request의 Body에는 "SAML Response"와 "Relay State"가 존재하는 것을 확인할 수 있다. Relay State는 [Text 1]의 Relay State와 동일한 것을 확인 할 수 있다. Service Provider는 ACS Endpoint로 전달되는 Relay State를 통해서 User를 "/session" Path로 Redirect 시키는 것을 판단하고 수행한다.

{% highlight xml %}
<?xml version="1.0"?>
<samlp:Response xmlns:samlp="urn:oasis:names:tc:SAML:2.0:protocol" xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion" Destination="http://localhost:8000/saml/acs" ID="ID_f315b052-60c2-46f5-9536-dda9034e71ab" InResponseTo="id-00c535d934e63f7519d60d1afbe4513cce7d13bb" IssueInstant="2022-02-27T13:55:40.326Z" Version="2.0">
  <saml:Issuer>http://localhost:8080/realms/ssup2</saml:Issuer>
  <dsig:Signature xmlns:dsig="http://www.w3.org/2000/09/xmldsig#">
    <dsig:SignedInfo>
      <dsig:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
      <dsig:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
      <dsig:Reference URI="#ID_f315b052-60c2-46f5-9536-dda9034e71ab">
        <dsig:Transforms>
          <dsig:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
          <dsig:Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
        </dsig:Transforms>
        <dsig:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
        <dsig:DigestValue>o4plaDgt1LTMoqupZaC9kq+85MbGJH1j4tH0eTgmAHM=</dsig:DigestValue>
      </dsig:Reference>
    </dsig:SignedInfo>
    <dsig:SignatureValue>XucrRf528RG25r19ERoOs8HESzBvitlq6qmm+7jK6N4GQZKUJENkFSc/qtrdYttCSV+a7p7EL2scqQPRJbWuxp1CsBRcvblJjtgsNnmVAXmLYkEQIrXu1s9g2YP6iXf/q7i9vrdU7PMjhsJSVWu75UUFrrQz45bJ2q7ylwH/K7irhw3F3pDCmSJzOjrFrEqETtCBD6HoS2MRSAIl+Dnyo6HVo0tXxWU057QuvrXQN8tnbeDSggD1sUgKWolWj3w0XpENszY+atiTfk6k7GXTALYyg5yQo6Ed7MU22cGJwSuQSUZ9Uind+IuumrTLieC1ewp9Y2T9jC7otOadTTwVQg==</dsig:SignatureValue>
    <dsig:KeyInfo>
      <dsig:KeyName>kZL4ywT4HLjExc7_GfGn5uoaHYyY6aoaj_g44eBSoVY</dsig:KeyName>
      <dsig:X509Data>
        <dsig:X509Certificate>MIICmTCCAYECBgF/HLGW7zANBgkqhkiG9w0BAQsFADAQMQ4wDAYDVQQDDAVzc3VwMjAeFw0yMjAyMjExNDI5MzRaFw0zMjAyMjExNDMxMTRaMBAxDjAMBgNVBAMMBXNzdXAyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAlplrdEgy+A83ShB5+yPlX7NtFAiS0aln/ZqGFSZYhd4pTTM5NS1EjZgU8oG3TfJ9dDlUEBA44hi1l21bicAejFIBXCUifjkuSMliXsGYf9djE0M7x6VMBSZCUaKKvz8/1D8kX/qJ2szWKsmB8VdR7HKbb2M7wmdu+Pd42FwJARfhRFYGoYH0gTDikU0l8QLdbOAb4NOBWgaA1h6BXo8FQaRrkOil0S1Rt6/dw6k/k/qHv/pmSGB8V8sn4OhtK3VKC/NFcKtPJF5y5DAC4d9YGcSgbhzhUuz2nZ7d/HszLVAtZvIUkIp3TddgqwnVTKEL4T+Z/4ma1f3QCIyaEQiMBwIDAQABMA0GCSqGSIb3DQEBCwUAA4IBAQBFCH+yKwGrTwGSlXXP27rE2rqjSIYnkzv0na+oCuATxbx+YnCEiKnrNTT+hUggbWns1VhaePFKny8mgPPrSFz5XF5mQtFCY1t9/kWMZDT/AovimoiPTzkyqv/KOHE1xgQ4Hi7Fxwk2TNvCJ+Ref29kc9XBux4yI9+f8UecM09vEbflTLUOaza0KOZKFXbuIRIqJZxABPGkmONB6Jw6zTIgmb91iMGVoSgBTWLDlp5EkbflZaZISk3m3NzT86IyKUi9U+zuoLmeKOFlLSxEyaCyAZtiiQvupUjCqfwUf9zttMcE63N0ZPQXa2J6mniZ2h5neBdPEiaXzl8dtyNZ4zfO</dsig:X509Certificate>
      </dsig:X509Data>
      <dsig:KeyValue>
        <dsig:RSAKeyValue>
          <dsig:Modulus>lplrdEgy+A83ShB5+yPlX7NtFAiS0aln/ZqGFSZYhd4pTTM5NS1EjZgU8oG3TfJ9dDlUEBA44hi1l21bicAejFIBXCUifjkuSMliXsGYf9djE0M7x6VMBSZCUaKKvz8/1D8kX/qJ2szWKsmB8VdR7HKbb2M7wmdu+Pd42FwJARfhRFYGoYH0gTDikU0l8QLdbOAb4NOBWgaA1h6BXo8FQaRrkOil0S1Rt6/dw6k/k/qHv/pmSGB8V8sn4OhtK3VKC/NFcKtPJF5y5DAC4d9YGcSgbhzhUuz2nZ7d/HszLVAtZvIUkIp3TddgqwnVTKEL4T+Z/4ma1f3QCIyaEQiMBw==</dsig:Modulus>
          <dsig:Exponent>AQAB</dsig:Exponent>
        </dsig:RSAKeyValue>
      </dsig:KeyValue>
    </dsig:KeyInfo>
  </dsig:Signature>
  <samlp:Status>
    <samlp:StatusCode Value="urn:oasis:names:tc:SAML:2.0:status:Success"/>
  </samlp:Status>
  <saml:EncryptedAssertion>
    <xenc:EncryptedData xmlns:xenc="http://www.w3.org/2001/04/xmlenc#" Type="http://www.w3.org/2001/04/xmlenc#Element">
      <xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#aes128-cbc"/>
      <ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
        <xenc:EncryptedKey>
          <xenc:EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p"/>
          <xenc:CipherData>
            <xenc:CipherValue>O4aXsgqn/IRC2LTehUNNxBCnfnYql408NpapE2q9dZ0D79PgdobNCVuk4E1v/v4aQW07K/7qFDKWA/tYWoIQBB+WG/Fq5yOnUnZ3qMFqagc1+Rfd8T6Ryg43EZ/FKY3NAZa74SFycI+0Gfz/EcqJ7+NyDIbC26tUnAUBNAuTFDgxo+BQyZNBL474JgBaR3vi6vgtcozp7UcMCRbiXAtWUX0kg14jTh3e87ntC3cRC+GJ/hLgxIPlGDyYlD9Fmuwx4wGk3U3TSQSMj9T9eB4PEwKq6/32fKKh+Fj+rshPz/h3wNbgKlpzZyAWXrdqm3Wg2jYfN5aOnN4/v2AC6yMwiw==</xenc:CipherValue>
          </xenc:CipherData>
        </xenc:EncryptedKey>
      </ds:KeyInfo>
      <xenc:CipherData>
        <xenc:CipherValue>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</xenc:CipherValue>
      </xenc:CipherData>
    </xenc:EncryptedData>
  </saml:EncryptedAssertion>
</samlp:Response>
{% endhighlight %}
<figure>
<figcaption class="caption">[Text 4] SAML Response</figcaption>
</figure>

[Text 3]의 SAML Response를 URL Decoding, Base64 Decoding을 수행하면 [Text 4]와 같은 XML 형태의 SAML Response를 얻을 수 있다.

{% highlight text %}
{
	{
		http://localhost:8000 1645973740  1645970140 http://localhost:8000 1645970140 G-cb2ffc92-c74c-4f05-997f-350cf64234c1
	} 
	map[Role:[manage-account manage-account-links uma_authorization default-roles-ssup2 offline_access view-profile] SessionIndex:[6ca1b65b-be38-44e2-a782-0a9374d1124e::acf9f286-2c16-46bf-8c1c-f2b7b7c97b42]] true
}
{% endhighlight %}
<figure>
<figcaption class="caption">[Text 5] Session 정보</figcaption>
</figure>

Service Provider의 "/session" Endpoint에 접근하면 [Text 5]과 같이 현재의 Session 정보를 확인할 수 있다. Role에 [그림 5]의 Role이 포함되어 있는것을 확인할 수 있다.

### 6. 참조

* [https://www.keycloak.org/getting-started/getting-started-docker](https://www.keycloak.org/getting-started/getting-started-docker)
* [https://docs.anchore.com/3.0/docs/overview/sso/examples/keycloak/](https://docs.anchore.com/3.0/docs/overview/sso/examples/keycloak/)
* [https://github.com/crewjam/saml](https://github.com/crewjam/saml)
* [https://goteleport.com/blog/how-saml-authentication-works/](https://goteleport.com/blog/how-saml-authentication-works/)
* [https://www.rancher.co.jp/docs/rancher/v2.x/en/admin-settings/authentication/keycloak/](https://www.rancher.co.jp/docs/rancher/v2.x/en/admin-settings/authentication/keycloak/)